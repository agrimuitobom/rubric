# ルーブリック ジェネレーター — Claude Code 引き継ぎ資料

## プロジェクト概要

教員向けのルーブリック（評価指標）自動生成Webアプリ。
Gemini APIを使い、評価対象・評価観点・段階数を入力するとAIがルーブリック表を生成する。
**他の教員に広く配布する前提**で開発中。GitHub Pagesでホスティングする。

## 技術構成

- **単一ファイル構成**: `index.html` のみ（HTML/CSS/JS一体）
- **外部依存**: Google Fonts（Noto Sans JP）のみ
- **API**: Gemini API（`gemini-2.5-flash`）をブラウザから直接呼び出し
- **フレームワーク不使用**: 素のHTML/CSS/JSで構成（React等なし）
- **サーバーレス**: 静的ファイルのみ。バックエンド不要

## 現在の実装済み機能

- Gemini APIによるルーブリック生成（JSON形式で取得→テーブル表示）
- 評価対象（必須）、評価観点（任意、空欄ならAI自動設定）、評価段階数（3〜6段階）の入力フォーム
- APIキーの入力・localStorage保存・表示/非表示切り替え
- APIキー削除ボタン（2段階確認: 「キー削除」→「本当に削除」）
- 生成結果のテーブル表示（スコア順ソート、色分け）
- CSV出力（BOM付きUTF-8、Excel対応）
- 新規作成ボタン（結果画面→入力画面に戻る）
- ダークテーマUI、フェードインアニメーション

## Gemini APIの呼び出し仕様

- エンドポイント: `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent`
- APIキーはクエリパラメータで渡す
- system_instructionに教育工学専門家としてのプロンプトを設定
- `responseMimeType: 'application/json'` でJSON出力を強制
- temperature: 0.3（安定した出力のため低め）

## APIレスポンスのJSON構造

```json
{
  "title": "ルーブリックのタイトル",
  "levels": [
    { "score": 4, "label": "卓越" },
    { "score": 3, "label": "達成" },
    { "score": 2, "label": "発展途上" },
    { "score": 1, "label": "努力を要する" }
  ],
  "rows": [
    {
      "criterion": "評価観点名",
      "descriptions": [
        { "score": 4, "text": "具体的な評価基準文..." },
        { "score": 3, "text": "..." }
      ]
    }
  ]
}
```

## セキュリティ上の設計方針

- **生徒情報は一切扱わない**（配布・普及のハードルを下げるため）
- APIキーはlocalStorageにのみ保存（サーバーに送信しない）
- ブラウザ→Google API間の直接HTTPS通信（第三者サーバーを経由しない）
- 共有端末対策として削除ボタンを実装済み

## 今後の改善タスク（優先度順）

### 優先度: 高

1. **ルーブリックのセル編集機能**
   - 生成後にテーブルのセルをクリックして文言を直接修正可能にする
   - 「AIの出力をたたき台に→微調整」のワークフロー実現
   - 編集後のデータでCSV出力できるようにする

2. **APIキー取得ガイドの内蔵**
   - Google AI Studio（https://aistudio.google.com/apikey）での取得手順
   - ページ内にステップ付きで表示（モーダルまたは折りたたみ）
   - ITに慣れていない教員向けにスクリーンショット的な説明

### 優先度: 中

3. **再生成ボタン**
   - 結果画面から同じ条件で再生成（入力し直す手間を省く）

4. **出力形式の追加**
   - PDF出力（印刷してすぐ授業で配布できる）
   - Excel(.xlsx)出力

5. **教科・校種の選択肢**
   - 「小学校/中学校/高校」「国語/数学/農業/...」などを選択
   - プロンプトに含めて生成精度を向上

### 優先度: 低

6. **テンプレート/履歴機能**
   - よく使うパターンをワンクリックで呼び出し
   - localStorageに過去の生成履歴を保存

7. **スマホ対応の強化**
   - スマホ表示時にテーブルをカード形式に切り替え

8. **初回オンボーディング**
   - 初回アクセス時に3ステップ程度の簡単な説明を表示

## 注意事項

- Gemini API無料枠は2025年12月に大幅縮小済み。`gemini-2.5-flash`は1日20〜50リクエスト程度。ルーブリック生成用途なら十分だが、配布時に上限がある旨の案内が必要。
- 当初 `gemini-2.0-flash` を使用していたが、無料枠のクォータが0になっていたため `gemini-2.5-flash` に変更した経緯あり。
- GitHub Pagesでのホスティング前提。ファイルはリポジトリのルートに `index.html` として配置。
